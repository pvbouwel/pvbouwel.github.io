<!doctype html><html lang=en><head><title>Kubernetes cheat sheet · Allinthemiddle</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="pvbouwel"><meta name=description content="Just some commands that had value at some time or another"><meta name=keywords content="blog,devops,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="Kubernetes cheat sheet"><meta name=twitter:description content="Just some commands that had value at some time or another"><meta property="og:url" content="http://pvbouwel.github.io/posts/kubernetes-cheatsheet/"><meta property="og:site_name" content="Allinthemiddle"><meta property="og:title" content="Kubernetes cheat sheet"><meta property="og:description" content="Just some commands that had value at some time or another"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-11-25T13:16:17+02:00"><meta property="article:modified_time" content="2023-11-25T13:16:17+02:00"><meta property="article:tag" content="Containers"><link rel=canonical href=http://pvbouwel.github.io/posts/kubernetes-cheatsheet/><link rel=preload href=/fonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.6445a802b9389c9660e1b07b724dcf5718b1065ed2d71b4eeaf981cc7cc5fc46.css integrity="sha256-ZEWoArk4nJZg4bB7ck3PVxixBl7S1xtO6vmBzHzF/EY=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin=anonymous media=screen><link rel=icon type=image/svg+xml href=/img/favicon.svg sizes=any><link rel=icon type=image/png href=/img/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/img/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/images/safari-pinned-tab.svg color=#5bbad5></head><body class="preload-transitions colorscheme-auto"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=http://pvbouwel.github.io/>Allinthemiddle
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa-solid fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/posts/>Blog</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=http://pvbouwel.github.io/posts/kubernetes-cheatsheet/>Kubernetes cheat sheet</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa-solid fa-calendar" aria-hidden=true></i>
<time datetime=2023-11-25T13:16:17+02:00>November 25, 2023
</time></span><span class=reading-time><i class="fa-solid fa-clock" aria-hidden=true></i>
One-minute read</span></div><div class=tags><i class="fa-solid fa-tag" aria-hidden=true></i>
<span class=tag><a href=/tags/containers/>Containers</a></span></div></div></header><div class=post-content><h1 id=debugging>Debugging
<a class=heading-link href=#debugging><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h1><p>Sometimes debugging is hard because you are using an optimized images without troubleshooting tools or even a shell. Ephemeral containers come to the rescue there with some useful kubectl debug commands but if you need to see the attached volumes these tools fall short and while it is possible to do it manually it is tedious. Make sure you are aware of kubectl-superdebug :
<a href=https://medium.com/datamindedbe/debugging-running-pods-on-kubernetes-2ba160c47ef5 class=external-link target=_blank rel=noopener>https://medium.com/datamindedbe/debugging-running-pods-on-kubernetes-2ba160c47ef5</a></p><h1 id=resources>Resources
<a class=heading-link href=#resources><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h1><h2 id=all-resources-in-a-namespace>All resources in a namespace
<a class=heading-link href=#all-resources-in-a-namespace><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>Just iterate over the resource type and look for them:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span><span style=color:#ff7b72>for</span> i in <span style=color:#a5d6ff>`</span>kubectl api-resources --verbs list --namespaced -o name<span style=color:#a5d6ff>`</span>; <span style=color:#ff7b72>do</span> kubectl get --sho-kind --ignore-not-found <span style=color:#79c0ff>$i</span>; <span style=color:#ff7b72>done</span>
</span></span></code></pre></div><h2 id=which-pods-still-have-persistent-volume-claim>Which pods still have persistent volume claim
<a class=heading-link href=#which-pods-still-have-persistent-volume-claim><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><pre tabindex=0><code>kubectl get pods --all-namespaces -o=json | jq -c &#39;.items[] | {name: .metadata.name, namespace: .metadata.namespace, claimName:.spec.volumes[] | select (has (&#34;persistentVolumeClaim&#34;) ).persistentVolumeClaim.claimName }&#39;
</code></pre><h1 id=networking>Networking
<a class=heading-link href=#networking><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h1><h2 id=jump-porals>Jump porals
<a class=heading-link href=#jump-porals><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>In order to do this you&rsquo;d need to be able to exec into pods and make sure socat is available on the pod. When that is possible it is possible to tunnel via the pod towards a target.</p><p>On the pod setup a tunnel to remote endpoint:</p><div class=highlight><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>socat tcp-l:&lt;local-port&gt;,fork,reuseaddr tcp:&lt;target-host&gt;:&lt;target-port&gt;
</span></span><span style=display:flex><span>kubectl port-forward pod/&lt;jump-pod&gt; &lt;local-port&gt;:&lt;target-port&gt;
</span></span></code></pre></div><p>resources:</p><ul><li><a href=https://exploit-notes.hdks.org/exploit/network/port-forwarding/port-forwarding-with-socat/ class=external-link target=_blank rel=noopener>socat command list</a></li><li><a href=https://kubernetes.io/docs/tasks/access-application-cluster/port-forward-access-application-cluster/ class=external-link target=_blank rel=noopener>k8s port-forward docs</a></li></ul></div><footer></footer></article></section></div><footer class=footer><section class=container>©
2009 -
2025
pvbouwel
·
Powered by <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/ target=_blank rel=noopener>Coder</a>.</section></footer></main><script src=/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script></body></html>